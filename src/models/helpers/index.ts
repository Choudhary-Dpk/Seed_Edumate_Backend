import prisma from "../../config/prisma";

export const getEmailTemplate = async (title: string) => {
  // As of now keeping static but can be changed if we will get the template
  if (title === "set-password") {
    return `<!DOCTYPE html><html><head><title>Set Password Email</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style type="text/css">body,p,table,td{margin:0;padding:0}table{border-collapse:collapse}img{border:0;display:block;max-width:100%;height:auto}a{text-decoration:none}@media screen and (max-width:600px){.container{width:100%!important;padding:0!important}.inner-table{width:100%!important}.stack-column{display:block!important;width:100%!important;text-align:center!important}.stack-column img{margin:0 auto!important}.stack-text{text-align:center!important;padding-top:8px!important}.content{padding:24px 20px!important;font-size:15px!important;line-height:1.6!important}.btn{font-size:14px!important;padding:10px 16px!important;display:inline-block!important}.footer-text{font-size:12px!important}}</style></head><body style="background-color:#f9f9f9;font-family:Arial,sans-serif"><table class="container" cellpadding="0" cellspacing="0" align="center" style="width:600px;max-width:600px;margin:auto;background-color:#fff;border:1px solid #eee"><tbody><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><table width="100%" cellpadding="0" cellspacing="0" class="inner-table"><tr><td class="stack-column" style="vertical-align:middle"><img src="https://edumateglobal.com/images/logos/edumate-logos/edumate_logo.png" alt="edumate" class="logo-img" style="height:48px;width:auto;filter:brightness(1.1)"></td><td class="stack-column stack-text" style="text-align:right;vertical-align:middle"><div style="font-size:13px;color:#0f172a;font-weight:600">Education Loan Services</div><div style="font-size:11px;color:#0f172aae;margin-top:2px">Your pathway to educational excellence</div></td></tr></table></td></tr><tr><td><table width="100%" style="background:#fff"><tbody><tr><td><table width="100%" align="center" class="content" style="max-width:540px;margin:auto;color:#474d6a;line-height:1.5;padding:32px 28px"><tbody><tr style="padding:0 16px;margin:0 10px"><td style="font-size:16px;color:#474d6a"><p style="margin:0">Hello <b>{%name%}</b>,</p><br><p style="margin:0">We have received a request to set the password for your account. To complete the process, please follow the link below:</p><br><p><a href="{%set-password-url%}" class="btn" style="display: block; text-align: center; background: #244780; color: #ffffff; padding: 14px 20px; border-radius: 8px; text-decoration: none; font-size: 14px; font-weight: 600; font-family: Inter, -apple-system, BlinkMacSystemFont, sans-serif; box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);">Set Password</a></p><br><p style="margin:0">Thank you for using our service.</p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><p class="footer-text" style="margin:0 0 12px 0;font-size:13px;color:#0f172a;font-weight:500">© {%currentYear%} Edumate. All rights reserved.</p><p style="margin:0;font-size:12px;color:#0f172aae;line-height:1.5">This email was sent regarding your loan application. Please do not reply directly to this email.</p></td></tr></tbody></table></body></html>`;
  }

  if (title === "otp") {
    return `<!DOCTYPE html><html><head><title>OTP Verification Email</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style type="text/css">body,p,table,td{margin:0;padding:0}table{border-collapse:collapse}img{border:0;display:block;max-width:100%;height:auto}a{text-decoration:none}@media screen and (max-width:600px){.container{width:100%!important;padding:0!important}.inner-table{width:100%!important}.stack-column{display:block!important;width:100%!important;text-align:center!important}.stack-column img{margin:0 auto!important}.stack-text{text-align:center!important;padding-top:8px!important}.content{padding:24px 20px!important;font-size:15px!important;line-height:1.6!important}.otp-code{font-size:20px!important;padding:12px!important}.footer-text{font-size:12px!important}}</style></head><body style="background-color:#f9f9f9;font-family:Arial,sans-serif"><table class="container" cellpadding="0" cellspacing="0" align="center" style="width:600px;max-width:600px;margin:auto;background-color:#fff;border:1px solid #eee"><tbody><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><table width="100%" cellpadding="0" cellspacing="0" class="inner-table"><tr><td class="stack-column" style="vertical-align:middle"><img src="https://edumateglobal.com/images/logos/edumate-logos/edumate_logo.png" alt="edumate" class="logo-img" style="height:48px;width:auto;filter:brightness(1.1)"></td><td class="stack-column stack-text" style="text-align:right;vertical-align:middle"><div style="font-size:13px;color:#0f172a;font-weight:600">Education Loan Services</div><div style="font-size:11px;color:#0f172aae;margin-top:2px">Your pathway to educational excellence</div></td></tr></table></td></tr><tr><td><table width="100%" style="background:#fff"><tbody><tr><td><table width="100%" align="center" class="content" style="max-width:540px;margin:auto;color:#474d6a;line-height:1.5;padding:32px 28px"><tbody><tr style="padding:0 16px;margin:0 10px"><td style="font-size:16px;color:#474d6a"><p style="margin:0">Hello <b>{%name%}</b>,</p><br><p style="margin:0">Use this OTP to login:</p><br><div style="text-align:center;margin:20px 0"><span class="otp-code" style="display:inline-block;background:#f8fafc;border:2px solid #244780;color:#244780;font-size:24px;font-weight:700;padding:16px 24px;border-radius:8px;letter-spacing:4px;font-family:monospace">{%otp%}</span></div><br><p style="margin:0">Thank you for using our service.</p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><p class="footer-text" style="margin:0 0 12px 0;font-size:13px;color:#0f172a;font-weight:500">© {%currentYear%} Edumate. All rights reserved.</p><p style="margin:0;font-size:12px;color:#0f172aae;line-height:1.5">This email was sent regarding your loan application. Please do not reply directly to this email.</p></td></tr></tbody></table></body></html>`;
  }

  if (title === "forgot-password") {
    return `<!DOCTYPE html><html><head><title>Reset Password Email</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><style type="text/css">body,p,table,td{margin:0;padding:0}table{border-collapse:collapse}img{border:0;display:block;max-width:100%;height:auto}a{text-decoration:none}@media screen and (max-width:600px){.container{width:100%!important;padding:0!important}.inner-table{width:100%!important}.stack-column{display:block!important;width:100%!important;text-align:center!important}.stack-column img{margin:0 auto!important}.stack-text{text-align:center!important;padding-top:8px!important}.content{padding:24px 20px!important;font-size:15px!important;line-height:1.6!important}.btn{font-size:14px!important;padding:10px 16px!important;display:inline-block!important}.footer-text{font-size:12px!important}}</style></head><body style="background-color:#f9f9f9;font-family:Arial,sans-serif"><table class="container" cellpadding="0" cellspacing="0" align="center" style="width:600px;max-width:600px;margin:auto;background-color:#fff;border:1px solid #eee"><tbody><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><table width="100%" cellpadding="0" cellspacing="0" class="inner-table"><tr><td class="stack-column" style="vertical-align:middle"><img src="https://edumateglobal.com/images/logos/edumate-logos/edumate_logo.png" alt="edumate" class="logo-img" style="height:48px;width:auto;filter:brightness(1.1)"></td><td class="stack-column stack-text" style="text-align:right;vertical-align:middle"><div style="font-size:13px;color:#0f172a;font-weight:600">Education Loan Services</div><div style="font-size:11px;color:#0f172aae;margin-top:2px">Your pathway to educational excellence</div></td></tr></table></td></tr><tr><td><table width="100%" style="background:#fff"><tbody><tr><td><table width="100%" align="center" class="content" style="max-width:540px;margin:auto;color:#474d6a;line-height:1.5;padding:32px 28px"><tbody><tr style="padding:0 16px;margin:0 10px"><td style="font-size:16px;color:#474d6a"><p style="margin:0">Hello <b>{%name%}</b>,</p><br><p style="margin:0">We have received a request to reset the password for your account. To complete the process, please follow the link below:</p><br><p><a href="{%reset-password-url%}" class="btn" style="display:block;text-align:center;background:#244780;color:#fff;padding:14px 20px;border-radius:8px;text-decoration:none;font-size:14px;font-weight:600;font-family:Inter,-apple-system,BlinkMacSystemFont,sans-serif;box-shadow:0 2px 8px rgba(59,130,246,.2)">Reset Password</a></p><br><p style="margin:0">Thank you for using our service.</p></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style="background:linear-gradient(135deg,rgba(222,156,111,.12) 0,rgba(102,153,220,.59) 100%);padding:24px 32px"><p class="footer-text" style="margin:0 0 12px 0;font-size:13px;color:#0f172a;font-weight:500">© {%currentYear%} Edumate. All rights reserved.</p><p style="margin:0;font-size:12px;color:#0f172aae;line-height:1.5">This email was sent regarding your loan application. Please do not reply directly to this email.</p></td></tr></tbody></table></body></html>`;
  }

  return "";
};

export const getUserDetailsByEmail = async (email: string) => {
  const userData = await prisma.user.findFirst({
    where: {
      email,
      is_active: true,
    },
    select: {
      id: true,
      is_active: true,
      email: true,
      password_hash: true,
      updated_at: true,
      full_name: true,
    },
  });

  return userData;
};
